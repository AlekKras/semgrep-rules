rules:
- id: express-check-exposed-metrics
  message: "Looks like a metrics route is being exposed. Consider moving this to an internal-facing application if not already."
  languages: [javascript, typescript]
  severity: INFO
  metadata:
    category: security
    cwe:
      - "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor"
    owasp:
      - "A05:2021 - Security Misconfiguration"
      - "A06:2017 - Security Misconfiguration"
      - "A03:2017 - Sensitive Data Exposure"
  patterns:
  - pattern-inside: |
      $APP = express()
      ...
  - pattern: |
      $APP.$REQTYPE('$ROUTE', ...)
  - metavariable-regex:
      metavariable: $ROUTE
      regex: ^\/.*metrics.*
