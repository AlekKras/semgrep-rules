rules:
- id: check-outdated-sanitize-html
  message: "Versions of the library sanitize-html < 2.3.2 are vulnerable to sanitization bypass and/or RCE. Recommended to update to version 2.3.2 or later."
  languages: [javascript, typescript]
  severity: WARNING
  metadata:
    category: security
    references: |
      - https://semgrep.dev
    cwe:
      - "CWE-00: VALUE"
    owasp:
      - "A00:2021 - VALUE"
      - "A00:2017 - VALUE"
  patterns:
    - pattern-inside: |
        require('sanitize-html')
        ...
    - pattern: |
        sanitizeHtml(...)
    - r2c-internal-project-depends-on:
      - namespace: npm
        package: sanitize-html
        version: "< 2.3.2"