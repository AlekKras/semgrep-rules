rules:
  - id: detect-replaceall-sanitization
    message: |
      If you're using replaceAll() for security sanitization purposes,
      consider using a well known sanitization library instead.
      Manually built sanitization lists are likely to be circumvented by attackers.
    languages:
      - javascript
      - typescript
    severity: WARNING
    pattern-either:
      - pattern: $STR.replaceAll('<', '&lt;')
      - pattern: $STR.replaceAll('>', '&gt;')
      - pattern: $STR.replaceAll('"', '&quot;')
      - pattern: $STR.replaceAll("'", '&apos;')
      - pattern: $STR.replaceAll('&', '&amp;')
    metadata:
      category: security
      technology:
        - javascript
        - typescript
      owasp:
        - A01:2017 - Injection
        - A03:2021 - Injection
